<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>用户主页</title>
</head>
<body>
    <h2>欢迎, {{ user.username }}</h2>
    <p>注册时间: {{ user.date_joined }}</p>
    <p>个人简介: {{ user.bio }}</p>
    {%if user.avatar %}
        <div>头像:</div>
        <img src="{{user.avatar.url}}" style='max-height:15%;max-width:10%'>
    {%else%}
        <p>暂无头像</p>
    {%endif%}
    <br>
    <br>
    <form method ="POST" enctype="multipart/form-data">
        {%csrf_token%}
        <div class="form-group">
            <label for = "avatar">上传头像</label>
            <input type='file' name="avatar"id='avatar'>
            <button type='submit'>提交头像</button>
        </div>
    </form>

    <h3>我的文章</h3>
    <ul>
        {% for article in articles %}
            <li>
                <a href="{% url 'article_detail' article.id %}">{{ article.title }}</a> - 创建于 {{ article.created_at }}
                <div>收藏数：<strong>{{article.favorite_count}}</strong> 点赞数：<strong>{{article.like_count}}</strong></div>
                <a href="{% url 'update_article' article.id %}">修改</a>
                <a href="{% url 'delete_article' article.id %}">删除</a>
            </li>
        {% endfor %}
    </ul>
    
    <h3>我的收藏夹</h3>
    <ul>
        {% for favorite in favorite_articles %}
            <li>
                <a href="{% url 'article_detail' favorite.article.id %}">{{ favorite.article.title }}</a> - 收藏于 {{ favorite.added_at }}
            </li>
        {% empty %}
            <li>你还没有收藏任何文章。</li>
        {% endfor %}
    </ul>

    <br>
    <h3><a href="{%url 'notifications:user_mailbox'%}">我的信箱</a></h3>
    {%if not_read_notifications.count%}
        <p style='color:red;font-size:30px'>你有<strong>{{not_read_notifications.count}}</strong>条未读信息</p>
    {%endif%}
    <hr>
    <br>
    <a href="{% url 'create_article' %}">创建新文章</a><br>
    <a href="{% url 'article_list' %}">看看别的文章</a>
    <a href="{% url 'logout' %}">登出</a>
    <a href="{% url 'delete_account' %}">注销</a>
</body>
</html>
